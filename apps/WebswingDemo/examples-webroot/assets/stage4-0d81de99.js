var f=Object.defineProperty;var y=(h,e,a)=>e in h?f(h,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):h[e]=a;var n=(h,e,a)=>(y(h,typeof e!="symbol"?e+"":e,a),a);import"./webswing-webcomponents-e5184f77.js";import{d as I,g as p}from"./utils-09aa2f1a.js";class T{constructor(e){n(this,"parent");n(this,"args");n(this,"connectionUrl");n(this,"elementSelectedTab");n(this,"elementTable");n(this,"elementMap");n(this,"elementIntro");n(this,"elementToast");n(this,"elementTabs");n(this,"elementCreateForm");n(this,"elementEditForm");n(this,"elementModalEditItem");n(this,"elementModalCreateItem");n(this,"elementModalDeleteItem");n(this,"elementWebswingRoot");n(this,"elementCreateRecord");n(this,"_webswingInstance");n(this,"getArrayOfTableCols",e=>{const a=this.elementTable.data.map(t=>t[e]);return Array.from(new Set(a))});n(this,"getServerUrl",()=>{const e=window.location.href;return e.substring(0,e.indexOf("/migration-examples"))+"/migration-examples"});n(this,"webswingInit",()=>{I.getWebswingApi(this.connectionUrl).then(e=>{this.webswingInstance=e.bootstrap(this.elementWebswingRoot,{connectionUrl:this.connectionUrl,autoStart:!1,args:this.args,debugPort:Number(p("debugPort")),onReady:()=>{var a;this.elementWebswingRoot.classList.add("authenticated"),(a=this.webswingInstance)==null||a.start()}},a=>{a.services.dialog.content.continueOldSessionDialog=null,a.services.base.handleActionEvent=(t,i)=>{var l,d;if(t==="initialize"&&((l=this.webswingInstance)==null||l.performAction({actionName:"switchStage",data:"4"}),(d=this.webswingInstance)==null||d.performAction({actionName:"getTableData"})),t==="setTableData"){const r=JSON.parse(i);this.uiTableInit(r)}if(t==="clickedAddButton"){const r=this.elementModalCreateItem,o=this.elementCreateForm;if(r.header="Create Nobel prize winner record",r.show=!0,i){const{categoryList:c,countryList:s}=JSON.parse(i);o.categories=c,o.countries=s}r.addEventListener("close",c=>{var s;if(c.detail==="ok"){const m=JSON.stringify(o.data);(s=this.webswingInstance)==null||s.performAction({actionName:"createItem",data:m}),o.reset()}})}if(t==="editWinner"){const r=this.elementModalEditItem,o=this.elementEditForm;if(r.header="Edit Nobel prize winner record",r.show=!0,i){const{categoryList:c,countryList:s,nobelPrizeWinner:m,row:b}=JSON.parse(i);o.categories=c,o.countries=s,o.data=m,r.addEventListener("close",u=>{var w;if(u.detail==="ok"){o.data.row=b;const g=JSON.stringify(o.data);(w=this.webswingInstance)==null||w.performAction({actionName:"editItem",data:g})}})}}}})}).catch(e=>{console.error(e)})});n(this,"uiTableInit",e=>{var o,c;const a=this.elementToast,t=this.elementTable,i=this.elementModalCreateItem,l=this.elementCreateForm,d=this.elementMap;t.headers=["ID","Name","Category","Award Year","Country"],t.data=e;const r=s=>{var m;i.removeEventListener("close",r),s.detail==="ok"&&(t.createRow(l.data),(m=this.webswingInstance)==null||m.performAction({actionName:"createItem",data:JSON.stringify(l.data)}),a.show("Record has been created sucessfuly"))};(c=(o=t.shadowRoot)==null?void 0:o.querySelector("button[data-id='createRecord']"))==null||c.addEventListener("click",()=>{i.header="Create Nobel prize winner record",l.categories=this.getArrayOfTableCols("category"),l.countries=this.getArrayOfTableCols("country"),i.show=!0}),d.addEventListener("click",s=>{const m=s.composedPath()[0].getAttribute("data-name");m&&(t.search=m)}),i.addEventListener("close",r),t.addEventListener("viewRow",s=>{this.createDetailClosableTab(s.detail)}),t.addEventListener("editRow",s=>{this.editSingleTableRow(s.detail)}),t.addEventListener("deleteRow",s=>{this.deleteSingleTableRow(s.detail)}),t.addEventListener("selectRow",s=>{if(d.active===s.detail){d.active="";return}d.active=s.detail})});this.parent=e,this.args="",this.connectionUrl=this.getServerUrl(),this.elementTable=e.querySelector("ws-table"),this.elementMap=e.querySelector("ws-map"),this.elementSelectedTab=e.querySelector('ws-tab[selected="true"]'),this.elementIntro=e.querySelector("ws-intro"),this.elementToast=e.querySelector("ws-toast"),this.elementTabs=e.querySelector("ws-tabs"),this.elementCreateForm=e.querySelector('ws-detail-form[data-id="createForm"]'),this.elementEditForm=e.querySelector('ws-detail-form[data-id="editForm"]'),this.elementModalEditItem=e.querySelector('ws-modal[data-id="editRecord"]'),this.elementModalCreateItem=e.querySelector('ws-modal[data-id="createRecord"]'),this.elementWebswingRoot=e.querySelector('[data-id="webswing-table"]'),this.elementModalDeleteItem=e.querySelector('ws-modal[data-id="deleteRecord"]'),this.elementCreateRecord=e.querySelector('button[data-id="createRecord"]'),this.webswingInit(),this.uiIntro()}get webswingInstance(){return this._webswingInstance}set webswingInstance(e){this._webswingInstance=e}createDetailClosableTab(e){const a=document.createElement("ws-tab"),t=document.createElement("ws-detail-form");a.label=e.name,this.elementTabs.appendChild(a),a.appendChild(t),this.elementTabs.selectTab(a),a.closable=!0,t.data=e,t.readonly=!0}editSingleTableRow(e){if(!e)return;const a=this.elementTable,t=this.elementModalEditItem,i=this.elementEditForm,l=this.elementToast;t.header="Edit Nobel prize winner record",t.show=!0,i.categories=this.getArrayOfTableCols("category"),i.countries=this.getArrayOfTableCols("country"),i.data=e;const d=r=>{var o;if(t.removeEventListener("close",d),r.detail==="ok"){const c=a.data.findIndex(m=>{var b;return m.id===((b=i.data)==null?void 0:b.id)});a.updateRow(c,i.data);const s=JSON.stringify(i.data);(o=this.webswingInstance)==null||o.performAction({actionName:"editListItem",data:s}),l.show("Record has been updated sucessfuly")}};t.addEventListener("close",d)}deleteSingleTableRow(e){if(!e)return;const a=this.elementTable,t=this.elementModalDeleteItem,i=this.elementToast;t.header="Remove Nobel prize winner record",t.show=!0;const l=d=>{var r;if(t.removeEventListener("close",l),d.detail==="ok"){const o=a.data.findIndex(c=>c.name===e.name);o!=null&&(a.deleteRow(o),(r=this.webswingInstance)==null||r.performAction({actionName:"removeItem",data:JSON.stringify(e)}),i.show("Record has been deleted sucessfuly"))}};t.addEventListener("close",l)}uiIntro(){this.elementIntro.addEventListener("introClick",()=>{const e=this.elementTabs,a=this.parent.querySelectorAll("ws-tab")[1];e.selectTab(a)})}}new T(document.body);
//# sourceMappingURL=stage4-0d81de99.js.map
